= semantic_form_for [:admin, @game] do |f|
  = f.inputs :name => "Logistics" do
    = f.input :season_id, :as => :select, :collection => @seasons
    = f.input :starts_on, :as => :string, :input_html => { :value => @game.starts_on ? I18n.l(@game.starts_on) : "" }
  = f.inputs :name => "Away Team" do
    = f.input :left_team_id, :collection => @teams
    = f.input :left_team_name
  = f.inputs :name => "Home Team" do
    = f.input :right_team_id, :collection => @teams
    = f.input :right_team_name
  = f.buttons do
    = f.commit_button
    %li #{link_to 'Cancel', session[:return_to]}

:javascript
  $(document).ready(function(){
      $("select#game_season_id").change(function(){
          var id_value_string = $(this).val();
          if (id_value_string == "") { 
              // if the id is empty remove all the sub_selection options from being selectable and do not do any ajax
              $("select[id$='team_id'] option").remove();
              var row = "<option value=\"" + "" + "\">" + "" + "</option>";
              $(row).appendTo("select[id$='team_id']");
          }
          else {
            $.ajax({
                dataType: "json",
                cache: false,
                url: '#{admin_teams_path}?season_id=' + id_value_string,
                timeout: 2000,
                error: function(XMLHttpRequest, errorTextStatus, error){
                    alert("Failed to submit : "+ errorTextStatus+" ;"+error);
                },
                success: function(data){  
                    $("select[id$='team_id'] option").remove();
                    var row = "<option value=\"" + "" + "\">" + "" + "</option>";
                    $(row).appendTo("select[id$='team_id']"); 
                    $.each(data, function(i, j){
                        row = "<option value=\"" + j._id + "\">" + j.name + " (" + j.division_name + " Division)</option>";
                        $(row).appendTo("select[id$='team_id']");
                    });
                 }
            });
          };
      });
  });



