- title 'Schedule'

- events = @events.entries

%div(class="grid lg:grid-cols-4 gap-6")
  %div(class="flex flex-col gap-y-4")
    - date = DateTime.now
    = render 'calendar', date: date
    = render 'calendar', date: date + 1.month
    = render 'tag_cloud', tags: @tags  

  %div(class="lg:col-span-3 flex flex-col gap-y-4")

    - last_date = nil
    
    = render 'no_events' if events.none?

    - events.group_by{|e| e.starts_on.to_date}.each do |date, day_events|
      %table(class="w-full border-separate border border-gray-200 rounded" style="border-spacing: 0")
        %thead
          %tr
            %th(colspan="2" class="border border-gray-200 text-left p-3 bg-gray-50")= date.strftime('%A, %B %e %Y')
        %tbody
          - day_events.each do |event|
            %tr
              %td(class="border border-gray-200 text-left p-3 w-1/3")
                - if event.all_day?
                  = 'All Day'
                - unless event.all_day?
                  = event.starts_on.strftime('%l:%M %P')
                  - unless event.class.name == 'League::Game'
                    != ' - '
                    = event.ends_on.strftime('%l:%M %P')  
              %td(class="border border-gray-200 text-left p-3 w-2/3")
                %div(class=" flex justify-between gap-2 flex-wrap items-center")
                  = event.summary
                  - if event.product.present? && event.product.active? && !event.product.private?
                    = link_to event.product, class: "bg-black hover:opacity-60 text-white p-2 flex gap-2 items-center text-sm rounded" do
                      %i.far.fa-edit
                      Register Online  
